{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/zifeizhou/code/doubao-seed-1-6-thinking-code-preview-/airtable-clone/src/server/auth-simple.js"],"sourcesContent":["// Simplified authentication for demonstration\n// This uses in-memory storage and doesn't require a database\n\nimport { createHash } from 'crypto';\n\nlet users = [];\nlet sessions = [];\n\nlet userIdCounter = 1;\nlet sessionIdCounter = 1;\n\nfunction hashPassword(password) {\n  return createHash('sha256').update(password).digest('hex');\n}\n\nexport const auth = {\n  api: {\n    async getSession({ ctx }) {\n      const cookie = ctx?.req?.headers?.cookie;\n      if (!cookie) return null;\n\n      const sessionCookie = cookie.split(';').find(c => c.trim().startsWith('session='));\n      if (!sessionCookie) return null;\n\n      const sessionId = sessionCookie.split('=')[1];\n      const session = sessions.find(s => s.id === sessionId && s.expiresAt > Date.now());\n\n      if (!session) return null;\n\n      const user = users.find(u => u.id === session.userId);\n      if (!user) return null;\n\n      return {\n        user: {\n          id: user.id,\n          email: user.email,\n          name: user.name,\n        },\n      };\n    },\n  },\n\n  async register({ email, password, name }) {\n    const existing = users.find(u => u.email === email);\n    if (existing) {\n      throw new Error('User already exists');\n    }\n\n    const user = {\n      id: `user_${userIdCounter++}`,\n      email,\n      password: hashPassword(password),\n      name: name || email.split('@')[0],\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    users.push(user);\n\n    const session = {\n      id: `session_${sessionIdCounter++}`,\n      userId: user.id,\n      expiresAt: Date.now() + 7 * 24 * 60 * 60 * 1000, // 7 days\n      createdAt: new Date(),\n    };\n\n    sessions.push(session);\n\n    return {\n      user,\n      session,\n    };\n  },\n\n  async login({ email, password }) {\n    const user = users.find(u => u.email === email);\n    if (!user) {\n      throw new Error('Invalid credentials');\n    }\n\n    if (user.password !== hashPassword(password)) {\n      throw new Error('Invalid credentials');\n    }\n\n    const session = {\n      id: `session_${sessionIdCounter++}`,\n      userId: user.id,\n      expiresAt: Date.now() + 7 * 24 * 60 * 60 * 1000, // 7 days\n      createdAt: new Date(),\n    };\n\n    sessions.push(session);\n\n    return {\n      user,\n      session,\n    };\n  },\n\n  async logout({ sessionId }) {\n    const index = sessions.findIndex(s => s.id === sessionId);\n    if (index !== -1) {\n      sessions.splice(index, 1);\n    }\n  },\n};"],"names":[],"mappings":"AAAA,8CAA8C;AAC9C,6DAA6D;;;;;AAE7D;;AAEA,IAAI,QAAQ,EAAE;AACd,IAAI,WAAW,EAAE;AAEjB,IAAI,gBAAgB;AACpB,IAAI,mBAAmB;AAEvB,SAAS,aAAa,QAAQ;IAC5B,OAAO,IAAA,mHAAU,EAAC,UAAU,MAAM,CAAC,UAAU,MAAM,CAAC;AACtD;AAEO,MAAM,OAAO;IAClB,KAAK;QACH,MAAM,YAAW,EAAE,GAAG,EAAE;YACtB,MAAM,SAAS,KAAK,KAAK,SAAS;YAClC,IAAI,CAAC,QAAQ,OAAO;YAEpB,MAAM,gBAAgB,OAAO,KAAK,CAAC,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI,GAAG,UAAU,CAAC;YACtE,IAAI,CAAC,eAAe,OAAO;YAE3B,MAAM,YAAY,cAAc,KAAK,CAAC,IAAI,CAAC,EAAE;YAC7C,MAAM,UAAU,SAAS,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,aAAa,EAAE,SAAS,GAAG,KAAK,GAAG;YAE/E,IAAI,CAAC,SAAS,OAAO;YAErB,MAAM,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,QAAQ,MAAM;YACpD,IAAI,CAAC,MAAM,OAAO;YAElB,OAAO;gBACL,MAAM;oBACJ,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;IACF;IAEA,MAAM,UAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE;QACtC,MAAM,WAAW,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK;QAC7C,IAAI,UAAU;YACZ,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,OAAO;YACX,IAAI,CAAC,KAAK,EAAE,iBAAiB;YAC7B;YACA,UAAU,aAAa;YACvB,MAAM,QAAQ,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;YACjC,WAAW,IAAI;YACf,WAAW,IAAI;QACjB;QAEA,MAAM,IAAI,CAAC;QAEX,MAAM,UAAU;YACd,IAAI,CAAC,QAAQ,EAAE,oBAAoB;YACnC,QAAQ,KAAK,EAAE;YACf,WAAW,KAAK,GAAG,KAAK,IAAI,KAAK,KAAK,KAAK;YAC3C,WAAW,IAAI;QACjB;QAEA,SAAS,IAAI,CAAC;QAEd,OAAO;YACL;YACA;QACF;IACF;IAEA,MAAM,OAAM,EAAE,KAAK,EAAE,QAAQ,EAAE;QAC7B,MAAM,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK;QACzC,IAAI,CAAC,MAAM;YACT,MAAM,IAAI,MAAM;QAClB;QAEA,IAAI,KAAK,QAAQ,KAAK,aAAa,WAAW;YAC5C,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,UAAU;YACd,IAAI,CAAC,QAAQ,EAAE,oBAAoB;YACnC,QAAQ,KAAK,EAAE;YACf,WAAW,KAAK,GAAG,KAAK,IAAI,KAAK,KAAK,KAAK;YAC3C,WAAW,IAAI;QACjB;QAEA,SAAS,IAAI,CAAC;QAEd,OAAO;YACL;YACA;QACF;IACF;IAEA,MAAM,QAAO,EAAE,SAAS,EAAE;QACxB,MAAM,QAAQ,SAAS,SAAS,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QAC/C,IAAI,UAAU,CAAC,GAAG;YAChB,SAAS,MAAM,CAAC,OAAO;QACzB;IACF;AACF"}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///Users/zifeizhou/code/doubao-seed-1-6-thinking-code-preview-/airtable-clone/src/app/api/auth/logout/route.js"],"sourcesContent":["import { auth } from '../../../../server/auth-simple';\n\nexport async function POST(req) {\n  try {\n    const cookie = req.headers.get('cookie');\n    if (cookie) {\n      const sessionCookie = cookie.split(';').find(c => c.trim().startsWith('session='));\n      if (sessionCookie) {\n        const sessionId = sessionCookie.split('=')[1];\n        await auth.logout({ sessionId });\n      }\n    }\n\n    const response = new Response(JSON.stringify({ message: 'Logout successful' }), {\n      status: 200,\n      headers: { 'Content-Type': 'application/json' },\n    });\n\n    response.headers.set('Set-Cookie', 'session=; HttpOnly; Path=/; Max-Age=0; SameSite=Lax');\n\n    return response;\n  } catch (error) {\n    return new Response(JSON.stringify({ error: error.message }), {\n      status: 500,\n      headers: { 'Content-Type': 'application/json' },\n    });\n  }\n}"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,GAAG;IAC5B,IAAI;QACF,MAAM,SAAS,IAAI,OAAO,CAAC,GAAG,CAAC;QAC/B,IAAI,QAAQ;YACV,MAAM,gBAAgB,OAAO,KAAK,CAAC,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI,GAAG,UAAU,CAAC;YACtE,IAAI,eAAe;gBACjB,MAAM,YAAY,cAAc,KAAK,CAAC,IAAI,CAAC,EAAE;gBAC7C,MAAM,mOAAI,CAAC,MAAM,CAAC;oBAAE;gBAAU;YAChC;QACF;QAEA,MAAM,WAAW,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,SAAS;QAAoB,IAAI;YAC9E,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAChD;QAEA,SAAS,OAAO,CAAC,GAAG,CAAC,cAAc;QAEnC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,IAAI;YAC5D,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAChD;IACF;AACF"}}]
}