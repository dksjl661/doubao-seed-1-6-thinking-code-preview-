{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/zifeizhou/code/doubao-seed-1-6-thinking-code-preview-/airtable-clone/src/server/auth-simple.js"],"sourcesContent":["// Simplified authentication for demonstration\n// This uses in-memory storage and doesn't require a database\n\nimport { createHash } from 'crypto';\n\nlet users = [];\nlet sessions = [];\n\nlet userIdCounter = 1;\nlet sessionIdCounter = 1;\n\nfunction hashPassword(password) {\n  return createHash('sha256').update(password).digest('hex');\n}\n\nexport const auth = {\n  api: {\n    async getSession({ ctx }) {\n      const cookie = ctx?.req?.headers?.cookie;\n      if (!cookie) return null;\n\n      const sessionCookie = cookie.split(';').find(c => c.trim().startsWith('session='));\n      if (!sessionCookie) return null;\n\n      const sessionId = sessionCookie.split('=')[1];\n      const session = sessions.find(s => s.id === sessionId && s.expiresAt > Date.now());\n\n      if (!session) return null;\n\n      const user = users.find(u => u.id === session.userId);\n      if (!user) return null;\n\n      return {\n        user: {\n          id: user.id,\n          email: user.email,\n          name: user.name,\n        },\n      };\n    },\n  },\n\n  async register({ email, password, name }) {\n    const existing = users.find(u => u.email === email);\n    if (existing) {\n      throw new Error('User already exists');\n    }\n\n    const user = {\n      id: `user_${userIdCounter++}`,\n      email,\n      password: hashPassword(password),\n      name: name || email.split('@')[0],\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    users.push(user);\n\n    const session = {\n      id: `session_${sessionIdCounter++}`,\n      userId: user.id,\n      expiresAt: Date.now() + 7 * 24 * 60 * 60 * 1000, // 7 days\n      createdAt: new Date(),\n    };\n\n    sessions.push(session);\n\n    return {\n      user,\n      session,\n    };\n  },\n\n  async login({ email, password }) {\n    const user = users.find(u => u.email === email);\n    if (!user) {\n      throw new Error('Invalid credentials');\n    }\n\n    if (user.password !== hashPassword(password)) {\n      throw new Error('Invalid credentials');\n    }\n\n    const session = {\n      id: `session_${sessionIdCounter++}`,\n      userId: user.id,\n      expiresAt: Date.now() + 7 * 24 * 60 * 60 * 1000, // 7 days\n      createdAt: new Date(),\n    };\n\n    sessions.push(session);\n\n    return {\n      user,\n      session,\n    };\n  },\n\n  async logout({ sessionId }) {\n    const index = sessions.findIndex(s => s.id === sessionId);\n    if (index !== -1) {\n      sessions.splice(index, 1);\n    }\n  },\n};"],"names":[],"mappings":"AAAA,8CAA8C;AAC9C,6DAA6D;;;;;AAE7D;;AAEA,IAAI,QAAQ,EAAE;AACd,IAAI,WAAW,EAAE;AAEjB,IAAI,gBAAgB;AACpB,IAAI,mBAAmB;AAEvB,SAAS,aAAa,QAAQ;IAC5B,OAAO,IAAA,mHAAU,EAAC,UAAU,MAAM,CAAC,UAAU,MAAM,CAAC;AACtD;AAEO,MAAM,OAAO;IAClB,KAAK;QACH,MAAM,YAAW,EAAE,GAAG,EAAE;YACtB,MAAM,SAAS,KAAK,KAAK,SAAS;YAClC,IAAI,CAAC,QAAQ,OAAO;YAEpB,MAAM,gBAAgB,OAAO,KAAK,CAAC,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI,GAAG,UAAU,CAAC;YACtE,IAAI,CAAC,eAAe,OAAO;YAE3B,MAAM,YAAY,cAAc,KAAK,CAAC,IAAI,CAAC,EAAE;YAC7C,MAAM,UAAU,SAAS,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,aAAa,EAAE,SAAS,GAAG,KAAK,GAAG;YAE/E,IAAI,CAAC,SAAS,OAAO;YAErB,MAAM,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,QAAQ,MAAM;YACpD,IAAI,CAAC,MAAM,OAAO;YAElB,OAAO;gBACL,MAAM;oBACJ,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;IACF;IAEA,MAAM,UAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE;QACtC,MAAM,WAAW,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK;QAC7C,IAAI,UAAU;YACZ,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,OAAO;YACX,IAAI,CAAC,KAAK,EAAE,iBAAiB;YAC7B;YACA,UAAU,aAAa;YACvB,MAAM,QAAQ,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;YACjC,WAAW,IAAI;YACf,WAAW,IAAI;QACjB;QAEA,MAAM,IAAI,CAAC;QAEX,MAAM,UAAU;YACd,IAAI,CAAC,QAAQ,EAAE,oBAAoB;YACnC,QAAQ,KAAK,EAAE;YACf,WAAW,KAAK,GAAG,KAAK,IAAI,KAAK,KAAK,KAAK;YAC3C,WAAW,IAAI;QACjB;QAEA,SAAS,IAAI,CAAC;QAEd,OAAO;YACL;YACA;QACF;IACF;IAEA,MAAM,OAAM,EAAE,KAAK,EAAE,QAAQ,EAAE;QAC7B,MAAM,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK;QACzC,IAAI,CAAC,MAAM;YACT,MAAM,IAAI,MAAM;QAClB;QAEA,IAAI,KAAK,QAAQ,KAAK,aAAa,WAAW;YAC5C,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,UAAU;YACd,IAAI,CAAC,QAAQ,EAAE,oBAAoB;YACnC,QAAQ,KAAK,EAAE;YACf,WAAW,KAAK,GAAG,KAAK,IAAI,KAAK,KAAK,KAAK;YAC3C,WAAW,IAAI;QACjB;QAEA,SAAS,IAAI,CAAC;QAEd,OAAO;YACL;YACA;QACF;IACF;IAEA,MAAM,QAAO,EAAE,SAAS,EAAE;QACxB,MAAM,QAAQ,SAAS,SAAS,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QAC/C,IAAI,UAAU,CAAC,GAAG;YAChB,SAAS,MAAM,CAAC,OAAO;QACzB;IACF;AACF"}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///Users/zifeizhou/code/doubao-seed-1-6-thinking-code-preview-/airtable-clone/src/server/trpc.js"],"sourcesContent":["import { initTRPC } from '@trpc/server';\nimport { auth } from './auth-simple';\n\nconst t = initTRPC.create();\n\nexport const middleware = t.middleware;\nexport const router = t.router;\nexport const publicProcedure = t.procedure;\n\nexport const protectedProcedure = t.procedure.use(\n  middleware(async ({ ctx, next }) => {\n    const session = await auth.api.getSession({ ctx });\n    if (!session) {\n      throw new Error('Unauthorized');\n    }\n    return next({\n      ctx: {\n        session,\n      },\n    });\n  })\n);"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,IAAI,yQAAQ,CAAC,MAAM;AAElB,MAAM,aAAa,EAAE,UAAU;AAC/B,MAAM,SAAS,EAAE,MAAM;AACvB,MAAM,kBAAkB,EAAE,SAAS;AAEnC,MAAM,qBAAqB,EAAE,SAAS,CAAC,GAAG,CAC/C,WAAW,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE;IAC7B,MAAM,UAAU,MAAM,mOAAI,CAAC,GAAG,CAAC,UAAU,CAAC;QAAE;IAAI;IAChD,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO,KAAK;QACV,KAAK;YACH;QACF;IACF;AACF"}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///Users/zifeizhou/code/doubao-seed-1-6-thinking-code-preview-/airtable-clone/src/db/memory.js"],"sourcesContent":["// In-memory database for demonstration purposes\n// This is a simplified version that doesn't require PostgreSQL\n\nlet users = [];\nlet tables = [];\nlet columns = [];\nlet rows = [];\nlet cellValues = [];\n\nlet userIdCounter = 1;\nlet tableIdCounter = 1;\nlet columnIdCounter = 1;\nlet rowIdCounter = 1;\nlet cellIdCounter = 1;\n\nexport const memoryDb = {\n  users: {\n    insert: async (values) => {\n      const user = {\n        id: `user_${userIdCounter++}`,\n        ...values,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n      };\n      users.push(user);\n      return [user];\n    },\n    find: async (where) => {\n      return users.filter(user => {\n        if (where.email?.equals) {\n          return user.email === where.email.equals;\n        }\n        return true;\n      });\n    },\n  },\n\n  tables: {\n    insert: async (values) => {\n      const table = {\n        id: `table_${tableIdCounter++}`,\n        ...values,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n      };\n      tables.push(table);\n      return [table];\n    },\n    findMany: async (where) => {\n      return tables.filter(table => {\n        if (where.userId?.equals) {\n          return table.userId === where.userId.equals;\n        }\n        return true;\n      }).sort((a, b) => b.createdAt - a.createdAt);\n    },\n    findFirst: async (where) => {\n      return tables.find(table => {\n        if (where.id?.equals && where.userId?.equals) {\n          return table.id === where.id.equals && table.userId === where.userId.equals;\n        }\n        return false;\n      });\n    },\n  },\n\n  columns: {\n    insert: async (values) => {\n      const column = {\n        id: `column_${columnIdCounter++}`,\n        ...values,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n      };\n      columns.push(column);\n      return [column];\n    },\n    findMany: async (where) => {\n      return columns.filter(column => {\n        if (where.tableId?.equals) {\n          return column.tableId === where.tableId.equals;\n        }\n        return true;\n      }).sort((a, b) => a.position - b.position);\n    },\n    findFirst: async (where) => {\n      return columns.find(column => {\n        if (where.id?.equals) {\n          return column.id === where.id.equals;\n        }\n        return false;\n      });\n    },\n    delete: async (where) => {\n      const index = columns.findIndex(column => column.id === where.id.equals);\n      if (index !== -1) {\n        const deleted = columns.splice(index, 1);\n        return deleted;\n      }\n      return [];\n    },\n  },\n\n  rows: {\n    insert: async (values) => {\n      const row = {\n        id: `row_${rowIdCounter++}`,\n        ...values,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n      };\n      rows.push(row);\n      return [row];\n    },\n    findMany: async (where) => {\n      return rows.filter(row => {\n        if (where.tableId?.equals) {\n          return row.tableId === where.tableId.equals;\n        }\n        return true;\n      }).sort((a, b) => a.order - b.order);\n    },\n    findFirst: async (where) => {\n      return rows.find(row => {\n        if (where.id?.equals) {\n          return row.id === where.id.equals;\n        }\n        return false;\n      });\n    },\n    delete: async (where) => {\n      const index = rows.findIndex(row => row.id === where.id.equals);\n      if (index !== -1) {\n        const deleted = rows.splice(index, 1);\n        return deleted;\n      }\n      return [];\n    },\n  },\n\n  cellValues: {\n    upsert: async (values) => {\n      const existing = cellValues.find(\n        cell => cell.rowId === values.rowId && cell.columnId === values.columnId\n      );\n\n      if (existing) {\n        existing.value = values.value;\n        existing.updatedAt = new Date();\n        return [existing];\n      } else {\n        const cell = {\n          id: `cell_${cellIdCounter++}`,\n          ...values,\n          createdAt: new Date(),\n          updatedAt: new Date(),\n        };\n        cellValues.push(cell);\n        return [cell];\n      }\n    },\n    findMany: async (where) => {\n      return cellValues.filter(cell => {\n        if (where.rowId?.in) {\n          return where.rowId.in.includes(cell.rowId);\n        }\n        return true;\n      });\n    },\n  },\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 355, "column": 0}, "map": {"version":3,"sources":["file:///Users/zifeizhou/code/doubao-seed-1-6-thinking-code-preview-/airtable-clone/src/server/routers/table-simple.js"],"sourcesContent":["import { z } from 'zod';\nimport { router, protectedProcedure } from '../trpc';\nimport { memoryDb } from '../../db/memory';\n\nexport const tableRouter = router({\n  create: protectedProcedure\n    .input(z.object({\n      name: z.string().min(1),\n      description: z.string().optional(),\n    }))\n    .mutation(async ({ input, ctx }) => {\n      const [table] = await memoryDb.tables.insert({\n        name: input.name,\n        description: input.description,\n        userId: ctx.session.user.id,\n      });\n\n      await memoryDb.columns.insert({\n        tableId: table.id,\n        name: 'Name',\n        type: 'text',\n        position: 0,\n      });\n\n      await memoryDb.columns.insert({\n        tableId: table.id,\n        name: 'Notes',\n        type: 'text',\n        position: 1,\n      });\n\n      return table;\n    }),\n\n  list: protectedProcedure\n    .query(async ({ ctx }) => {\n      return memoryDb.tables.findMany({\n        userId: { equals: ctx.session.user.id },\n      });\n    }),\n\n  get: protectedProcedure\n    .input(z.object({ id: z.string() }))\n    .query(async ({ input, ctx }) => {\n      const table = await memoryDb.tables.findFirst({\n        id: { equals: input.id },\n        userId: { equals: ctx.session.user.id },\n      });\n\n      if (!table) throw new Error('Table not found');\n\n      const tableColumns = await memoryDb.columns.findMany({\n        tableId: { equals: input.id },\n      });\n\n      const tableRows = await memoryDb.rows.findMany({\n        tableId: { equals: input.id },\n      });\n\n      const cellValuesMap = new Map();\n      if (tableRows.length > 0) {\n        const cells = await memoryDb.cellValues.findMany({\n          rowId: { in: tableRows.map(r => r.id) },\n        });\n        cells.forEach(cell => {\n          const key = `${cell.rowId}-${cell.columnId}`;\n          cellValuesMap.set(key, cell.value);\n        });\n      }\n\n      const rowsWithCells = tableRows.map(row => {\n        const cells = {};\n        tableColumns.forEach(col => {\n          const key = `${row.id}-${col.id}`;\n          cells[col.id] = cellValuesMap.get(key) ?? null;\n        });\n        return { ...row, cells };\n      });\n\n      return {\n        ...table,\n        columns: tableColumns,\n        rows: rowsWithCells,\n      };\n    }),\n\n  addColumn: protectedProcedure\n    .input(z.object({\n      tableId: z.string(),\n      name: z.string().min(1),\n      type: z.string().default('text'),\n      position: z.number().optional(),\n    }))\n    .mutation(async ({ input, ctx }) => {\n      const table = await memoryDb.tables.findFirst({\n        id: { equals: input.tableId },\n        userId: { equals: ctx.session.user.id },\n      });\n\n      if (!table) throw new Error('Table not found');\n\n      const existingColumns = await memoryDb.columns.findMany({\n        tableId: { equals: input.tableId },\n      });\n\n      const position = input.position ?? (existingColumns.length > 0 ? Math.max(...existingColumns.map(c => c.position)) + 1 : 0);\n\n      return memoryDb.columns.insert({\n        tableId: input.tableId,\n        name: input.name,\n        type: input.type,\n        position,\n      });\n    }),\n\n  deleteColumn: protectedProcedure\n    .input(z.object({ id: z.string() }))\n    .mutation(async ({ input, ctx }) => {\n      const column = await memoryDb.columns.findFirst({\n        id: { equals: input.id },\n      });\n\n      if (!column) throw new Error('Column not found');\n\n      const table = await memoryDb.tables.findFirst({\n        id: { equals: column.tableId },\n        userId: { equals: ctx.session.user.id },\n      });\n\n      if (!table) throw new Error('Unauthorized');\n\n      return memoryDb.columns.delete({\n        id: { equals: input.id },\n      });\n    }),\n\n  addRow: protectedProcedure\n    .input(z.object({ tableId: z.string() }))\n    .mutation(async ({ input, ctx }) => {\n      const table = await memoryDb.tables.findFirst({\n        id: { equals: input.tableId },\n        userId: { equals: ctx.session.user.id },\n      });\n\n      if (!table) throw new Error('Table not found');\n\n      const existingRows = await memoryDb.rows.findMany({\n        tableId: { equals: input.tableId },\n      });\n\n      const order = existingRows.length > 0 ? Math.max(...existingRows.map(r => r.order)) + 1 : 0;\n\n      return memoryDb.rows.insert({\n        tableId: input.tableId,\n        order,\n      });\n    }),\n\n  deleteRow: protectedProcedure\n    .input(z.object({ id: z.string() }))\n    .mutation(async ({ input, ctx }) => {\n      const row = await memoryDb.rows.findFirst({\n        id: { equals: input.id },\n      });\n\n      if (!row) throw new Error('Row not found');\n\n      const table = await memoryDb.tables.findFirst({\n        id: { equals: row.tableId },\n        userId: { equals: ctx.session.user.id },\n      });\n\n      if (!table) throw new Error('Unauthorized');\n\n      return memoryDb.rows.delete({\n        id: { equals: input.id },\n      });\n    }),\n\n  updateCell: protectedProcedure\n    .input(z.object({\n      rowId: z.string(),\n      columnId: z.string(),\n      value: z.any(),\n    }))\n    .mutation(async ({ input, ctx }) => {\n      const row = await memoryDb.rows.findFirst({\n        id: { equals: input.rowId },\n      });\n\n      if (!row) throw new Error('Row not found');\n\n      const table = await memoryDb.tables.findFirst({\n        id: { equals: row.tableId },\n        userId: { equals: ctx.session.user.id },\n      });\n\n      if (!table) throw new Error('Unauthorized');\n\n      return memoryDb.cellValues.upsert({\n        rowId: input.rowId,\n        columnId: input.columnId,\n        value: input.value,\n      });\n    }),\n});"],"names":[],"mappings":"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"}},
    {"offset": {"line": 577, "column": 0}, "map": {"version":3,"sources":["file:///Users/zifeizhou/code/doubao-seed-1-6-thinking-code-preview-/airtable-clone/src/server/routers/_app.js"],"sourcesContent":["import { router } from '../trpc';\nimport { tableRouter } from './table-simple';\n\nexport const appRouter = router({\n  table: tableRouter,\n});\n\n// Type exports are not supported in pure JavaScript\n// export type AppRouter = typeof appRouter;"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,MAAM,YAAY,IAAA,2NAAM,EAAC;IAC9B,OAAO,sPAAW;AACpB,IAEA,oDAAoD;CACpD,4CAA4C"}},
    {"offset": {"line": 593, "column": 0}, "map": {"version":3,"sources":["file:///Users/zifeizhou/code/doubao-seed-1-6-thinking-code-preview-/airtable-clone/src/app/api/trpc/%5Btrpc%5D/route.js"],"sourcesContent":["import { fetchRequestHandler } from '@trpc/server/adapters/fetch';\nimport { appRouter } from '../../../../server/routers/_app';\nimport { auth } from '../../../../server/auth-simple';\n\nconst handler = (req) =>\n  fetchRequestHandler({\n    endpoint: '/api/trpc',\n    req,\n    router: appRouter,\n    createContext: async () => {\n      const session = await auth.api.getSession({ req });\n      return { session };\n    },\n  });\n\nexport { handler as GET, handler as POST };"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEA,MAAM,UAAU,CAAC,MACf,IAAA,0RAAmB,EAAC;QAClB,UAAU;QACV;QACA,QAAQ,yOAAS;QACjB,eAAe;YACb,MAAM,UAAU,MAAM,mOAAI,CAAC,GAAG,CAAC,UAAU,CAAC;gBAAE;YAAI;YAChD,OAAO;gBAAE;YAAQ;QACnB;IACF"}}]
}